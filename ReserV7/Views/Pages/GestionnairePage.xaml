<Page
  x:Class="ReserV7.Views.Pages.GestionnairePage"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:local="clr-namespace:ReserV7.Views.Pages"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
  Title="Gestionnaire"
  d:DataContext="{d:DesignInstance local:GestionnairePage,
                                     IsDesignTimeCreatable=False}"
  d:DesignHeight="450"
  d:DesignWidth="800"
  ui:Design.Background="{DynamicResource ApplicationBackgroundBrush}"
  ui:Design.Foreground="{DynamicResource TextFillColorPrimaryBrush}"
  Foreground="{DynamicResource TextFillColorPrimaryBrush}"
  mc:Ignorable="d"
>
  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>

    <StackPanel Grid.Row="0" Margin="20" Orientation="Horizontal">
      <Border Background="{DynamicResource ControlFillColorDefaultBrush}" CornerRadius="8" Padding="15" Margin="0,0,20,0">
        <StackPanel>
          <TextBlock Foreground="{DynamicResource TextFillColorSecondaryBrush}" Text="Total Réservations" />
          <TextBlock FontSize="24" FontWeight="Bold" Text="{Binding ViewModel.TotalReservations}" />
        </StackPanel>
      </Border>

      <Border Background="{DynamicResource ControlFillColorDefaultBrush}" CornerRadius="8" Padding="15" Margin="0,0,20,0">
        <StackPanel>
          <TextBlock Foreground="{DynamicResource TextFillColorSecondaryBrush}" Text="En Attente" />
          <TextBlock FontSize="24" FontWeight="Bold" Foreground="Orange" Text="{Binding ViewModel.ReservationsEnAttente}" />
        </StackPanel>
      </Border>

      <Border Background="{DynamicResource ControlFillColorDefaultBrush}" CornerRadius="8" Padding="15">
        <StackPanel>
          <TextBlock Foreground="{DynamicResource TextFillColorSecondaryBrush}" Text="Total Utilisateurs" />
          <TextBlock FontSize="24" FontWeight="Bold" Text="{Binding ViewModel.TotalUtilisateurs}" />
        </StackPanel>
      </Border>
    </StackPanel>

    <Grid Grid.Row="1">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="300" />
      </Grid.ColumnDefinitions>

      <ListBox Grid.Column="0" ItemsSource="{Binding ViewModel.Reservations, Mode=OneWay}" Margin="20,0,0,20" SelectedItem="{Binding ViewModel.SelectedReservation, Mode=TwoWay}">
        <ListBox.ItemTemplate>
          <DataTemplate>
            <Border Padding="10" BorderThickness="0,0,0,1" BorderBrush="{DynamicResource ControlBorderBrush}">
              <Grid>
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="*" />
                  <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <StackPanel Grid.Column="0">
                  <TextBlock FontWeight="Bold" Text="{Binding Salle.Nom}" />
                  <TextBlock Foreground="{DynamicResource TextFillColorSecondaryBrush}" Text="{Binding User.Nom}" />
                  <TextBlock Foreground="{DynamicResource TextFillColorTertiaryBrush}" Text="{Binding DateDebut}" />
                  <TextBlock Foreground="{DynamicResource TextFillColorTertiaryBrush}" Text="{Binding HeureDebut}" />
                </StackPanel>
                <TextBlock Grid.Column="1" VerticalAlignment="Center" Text="{Binding Statut}" FontWeight="Bold" />
              </Grid>
            </Border>
          </DataTemplate>
        </ListBox.ItemTemplate>
      </ListBox>

      <StackPanel Grid.Column="1" Margin="20">
        <TextBlock FontSize="16" FontWeight="Bold" Text="Actions" Margin="0,0,0,12" />

        <TextBlock Text="Statut" Margin="0,0,0,4" />
        <ComboBox SelectedItem="{Binding ViewModel.SelectedStatut, Mode=TwoWay}" Margin="0,0,0,12">
          <ComboBoxItem>En attente</ComboBoxItem>
          <ComboBoxItem>Confirmée</ComboBoxItem>
          <ComboBoxItem>Annulée</ComboBoxItem>
          <ComboBoxItem>Terminée</ComboBoxItem>
        </ComboBox>

        <Button Command="{Binding ViewModel.UpdateReservationStatutCommand}" Content="Mettre à Jour" Margin="0,0,0,8" />
        <Button Command="{Binding ViewModel.AnnulerReservationCommand}" Content="Annuler" Margin="0,0,0,12" />

        <Separator Margin="0,10,0,10" />

        <Button Command="{Binding ViewModel.RefreshDataCommand}" Content="Actualiser" Margin="0,0,0,8" />
        <Button Command="{Binding ViewModel.ExportReservationsCommand}" Content="Exporter" />
      </StackPanel>
    </Grid>
  </Grid>
</Page>
